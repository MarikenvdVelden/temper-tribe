---
output: 
  stevetemplates::article:
    number_sections: TRUE
    toc: yes
    dev: cairo_pdf
title: "ONLINE APPENDIX: All Tarred with the Same Brush? A Comparative Study of Populist Support Predicting Conspiracy Thinking during the COVID-19 Pandemic"
bibliography: references.bib
biblio-style: apsr
geometry: margin=1in
date: "`r format(Sys.time(), '%B %d, %Y')`"
fontsize: 11pt
endnotes: FALSE
mainfont: cochineal
sansitup: FALSE
params:
  anonymous: ""
  doublespacing: ""
  removetitleabstract: ""
appendix: TRUE
appendixletter: "A"
pandocparas: FALSE
anonymous: "`r params$anonymous`"
doublespacing: "`r params$doublespacing`"
removetitleabstract: "`r params$removetitleabstract`"
linkcolor: black
#nocite: |
#  @cartersmith2020fml, @andersetal2020bbgb
header-includes: 
   - \usepackage{array}
   - \usepackage{floatrow}
   - \floatsetup[figure]{capposition=top}
   - \floatsetup[table]{capposition=top}
   - \usepackage{booktabs}
   - \usepackage{longtable}
   - \usepackage{array}
   - \usepackage{multirow}
   - \usepackage{wrapfig}
   - \usepackage{float}
   - \usepackage{colortbl}
   - \usepackage{pdflscape}
   - \usepackage{tabu}
   - \usepackage[para,online,flushleft]{threeparttable}
   - \usepackage{threeparttablex}
   - \usepackage[normalem]{ulem}
   - \usepackage{makecell}
   - \usepackage{xcolor}
   - \usepackage{caption}
   - \usepackage{graphicx}
   - \usepackage{epstopdf}
   - \usepackage{siunitx}
   - \usepackage{multirow}
   - \usepackage{hhline}
   - \usepackage{calc}
   - \usepackage{tabularx}
   - \usepackage{fontawesome}
   - \usepackage{amsthm}
   - \usepackage{csquotes}
   - \LTcapwidth=.95\textwidth
   - \linespread{1.05}
   - \usepackage{hyperref}
   - \usepackage{setspace}
   - \renewcommand{\thepage}{A-\arabic{page}}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message=FALSE, warning=FALSE)
options(kableExtra.latex.load_packages = FALSE)
options(tinytex.verbose = TRUE)
options(scipen = 1, digits = 2)
knitr::opts_chunk$set(fig.pos = "h", out.extra = "")
# Uncomment below if you want code captions
# oldSource <- knitr::knit_hooks$get("source")
# knitr::knit_hooks$set(source = function(x, options) {
#   x <- oldSource(x, options)
#   x <- ifelse(!is.null(options$code.cap), paste0(x, "\\captionof{chunk}{", options$code.cap,"}"), x)
#   ifelse(!is.null(options$ref), paste0(x, "\\label{", options$ref,"}"), x)
# })
# Add `chunkcaption: TRUE` to YAML as well.
```

```{r "env", message=FALSE, warning=F}
rm(list=ls())
here::i_am("report/online-appendix.Rmd")
source(here::here("src/lib/functions.R"))
load(here("data/intermediate/cleaned_catteneo_w1.RData"))
load(here("data/intermediate/cleaned_catteneo_w2.RData"))
```
\newpage
# Questionnaire and Descriptive Information
## Dependent Variables
We rely on two variables to operationalize conspiracy thinking: _Covid Conspiracy Beliefs_ and _Generic Conspicay Mentality_.
Both variables are created by using an additive scale.
Figure \ref{fig:scaling} demonstrates that while the Generic Conspicay Mentality index has higher values of Cronbach's alpha (`>0.8` for all countries), the Covid Conspiracy Beliefs index performs well enough, with a 
Cronbach's alpha higher than `0.7`. 
We have therefore included the scales as dependent variables in our analysis.
Table \ref{tab:dv} demonstrates the averages of the indexes across countries.

```{r "scaling", fig.width=6, fig.height=4, fig.cap="\\label{fig:scaling}Scale Performance"}
source(here("src/analysis/scaling.R"))
lt <- "dashed"
extrafont::loadfonts()
picom %>% 
   add_case(conspiracycovid) %>% 
   rename(Study = Wave) %>% 
   mutate(Study = recode(Study,
                         `1` = "Study 1",
                         `2` = "Study 2"),
          Variable = recode(Variable,
                            `PICOM` = "General Conspiracy Mentality",
                            `Covid Specific Conspiracy Beliefs` = "Covid Conspiracy Beliefs")) %>% 
  ggplot(aes(x = `Cronbach's Alpha`, y = Country,
             xmin = `CI Lower`, xmax = `CI Upper`,
             color = Variable, shape = Study)) +
  geom_point(position = position_dodge(.5)) +
  geom_errorbar(position = position_dodge(.5),
                width = 0) +
  labs(x = "Chronbach's Alpha", y = "",
       caption = "CI's calculated with a 1000 bootstrap samples") +
  scale_color_manual(values = c(fig_cols)) +
  hrbrthemes::theme_ipsum() +
  geom_vline(xintercept = 0.7, linetype = "dotted") +
  theme(plot.title = element_text(hjust = 0.5),
                       legend.position="bottom",
                       legend.title = element_blank()) 
rm(tmp, conspiracycovid, picom, df)
```

```{r dv, topcaption=TRUE}
d1 <- w1 %>% 
   select(covidconsp_index, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(covidconsp_index),2),
             `St.Dev` = round(sd(covidconsp_index),2),
             `Min.Value` = min(covidconsp_index),
             `Max.Value` = max(covidconsp_index)) %>%
   ungroup() %>% 
   mutate(Study = "Study 1",
          Variable = "Covid Conspiracy Beliefs")

d2a <- w2 %>% 
   select(covidconsp_index, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(covidconsp_index),2),
             `St.Dev` = round(sd(covidconsp_index),2),
             `Min.Value` = min(covidconsp_index),
             `Max.Value` = max(covidconsp_index)) %>%
   ungroup() %>% 
   mutate(Study = "Study 2",
          Variable = "Covid Conspiracy Beliefs")

d2b <- w2 %>% 
  select(picom_index, country) %>% 
  group_by(country) %>% 
   summarise(`Mean Value` = round(mean(picom_index),2),
             `St.Dev` = round(sd(picom_index),2),
             `Min.Value` = min(picom_index),
             `Max.Value` = max(picom_index)) %>%
   ungroup() %>% 
   mutate(Study = "Study 2",
          Variable = "Conspiracy Mentality")

d <- d1 %>% 
   add_case(d2a) %>% 
   add_case(d2b) %>% 
   select(Country = country, Study,
          Variable, `Mean Value`, `St.Dev`, 
          `Min.Value`, `Max.Value`) %>%
   mutate(Country = recode(Country,
                           `DE` = "Germany",
                           `FR` = "France",
                           `IT` = "Italy",
                           `PL` = "Poland",
                           `SP` = "Spain",
                           `SW` = "Sweden"))

kbl(d, booktabs =T, caption = "\\label{tab:dv}Descriptive Information - DV") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "4.5cm") %>%
  column_spec(4, width = "2cm") %>%
  column_spec(5, width = "1.5cm") %>%
  column_spec(6, width = "1.5cm") %>%
  column_spec(7, width = "1.5cm")

```
## Independent Variables
We rely on four variables to operationalize support for populist and extremist parties (i.e. to test our first hypothesis):

- _Propensity to Vote for Populist Party_ measured by the question form `0` to `10` how likely are you ever to vote for [party], where `0` means never and `10` means certainly vote for this party.
- _Populist Party ID_ measured by the question if you feel close to a party, respondents that indicated to feel close to a populist party received a score of `1`, others a score of `0`.
- _Populist Vote Recall_ measured by the question for which party you voted for during the last national elections, respondents that indicated that they voted for a populist party received a score of `1`, others a score of `0`.
- _Populist Vote Intention_ measured by the question for which party you aim to vote were there national elections tomorrow, respondents that indicated that they would vote for a populist party received a score of `1`, others a score of `0`. 

Tables \ref{tab:ivh1-1} and \ref{tab:ivh1-2} demonstrate the averages across countries.

```{r ivh1, topcaption=TRUE}
d1a <- w1 %>% 
   select(pop_pid, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(pop_pid),2),
             `St.Dev` = round(sd(pop_pid),2),
             `Min.Value` = min(pop_pid),
             `Max.Value` = max(pop_pid)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Populist Party Identity")

d1b <- w1 %>% 
   select(pop_vote_intention, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(pop_vote_intention),2),
             `St.Dev` = round(sd(pop_vote_intention),2),
             `Min.Value` = min(pop_vote_intention),
             `Max.Value` = max(pop_vote_intention)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Populist Vote Intention")

d2a <- w2 %>% 
   select(pop_pid, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(pop_pid),2),
             `St.Dev` = round(sd(pop_pid),2),
             `Min.Value` = min(pop_pid),
             `Max.Value` = max(pop_pid)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Populist Party Identity")

d2b <- w2 %>% 
   select(pop_vote_intention, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(pop_vote_intention),2),
             `St.Dev` = round(sd(pop_vote_intention),2),
             `Min.Value` = min(pop_vote_intention),
             `Max.Value` = max(pop_vote_intention)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Populist Vote Intention")

d2c <- w2 %>% 
   select(pop_ptv, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(pop_ptv),2),
             `St.Dev` = round(sd(pop_ptv),2),
             `Min.Value` = min(pop_ptv),
             `Max.Value` = max(pop_ptv)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "PTV for Populist Party")

d2d <- w2 %>% 
   select(pop_vote_recall, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(pop_vote_recall),2),
             `St.Dev` = round(sd(pop_vote_recall),2),
             `Min.Value` = min(pop_vote_recall),
             `Max.Value` = max(pop_vote_recall)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Populist Vote Last Election")

d <- d1a %>% 
   add_case(d1b) %>% 
   add_case(d2a) %>% 
   add_case(d2b) %>% 
   add_case(d2c) %>% 
   add_case(d2d) %>% 
   select(Country = country,Study = study,
          Variable, `Mean Value`, `St.Dev`, 
          `Min.Value`, `Max.Value`) %>%
   mutate(Country = recode(Country,
                           `DE` = "Germany",
                           `FR` = "France",
                           `IT` = "Italy",
                           `PL` = "Poland",
                           `SP` = "Spain",
                           `SW` = "Sweden"))

kbl(d, booktabs =T, caption = "\\label{tab:ivh1-1}Descriptive Information - Independent Variables for H1 (1)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "4cm") %>%
  column_spec(4, width = "2cm") %>%
  column_spec(5, width = "1.5cm") %>%
  column_spec(6, width = "1.5cm")  %>%
  column_spec(7, width = "1.5cm") 
```

We rely on eight measures to operationalize distance between themselves and the incumbent government party/parties. We look at the mean and median ideological distance from the government parties as determined by the respondents as well as determined by the sample based on the left-right scale as well as based on a covid policy specific scale to test our second hypothesis.
These eight measures are only available for study 1. 
Tables \ref{tab:ivh2-1} and ref{tab:ivh2-2} demonstrate the averages across countries.

```{r ivh2, topcaption=TRUE}
d1a <- w1 %>% 
   select(government_distanter_median, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(government_distanter_median),2),
             `St.Dev` = round(sd(government_distanter_median),2),
             `Min.Value` = min(government_distanter_median),
             `Max.Value` = max(government_distanter_median)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Ideological Distance from Median Government Position (R)")

d1b <- w1 %>% 
   select(government_distanter_mean, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(government_distanter_mean),2),
             `St.Dev` = round(sd(government_distanter_mean),2),
             `Min.Value` = min(government_distanter_mean),
             `Max.Value` = max(government_distanter_mean)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Ideological Distance from Mean Government Position (R)")

d1c <- w1 %>% 
   select(generalgovernment_distanter_median, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(generalgovernment_distanter_median),2),
             `St.Dev` = round(sd(generalgovernment_distanter_median),2),
             `Min.Value` = min(generalgovernment_distanter_median),
             `Max.Value` = max(generalgovernment_distanter_median)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Ideological Distance from Median Government Position (S)")

d1d <- w1 %>% 
   select(generalgovernment_distanter_mean, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(generalgovernment_distanter_mean),2),
             `St.Dev` = round(sd(generalgovernment_distanter_mean),2),
             `Min.Value` = min(generalgovernment_distanter_mean),
             `Max.Value` = max(generalgovernment_distanter_mean)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Ideological Distance from Mean Government Position (S)")

d1e <- w1 %>% 
   select(covidgovernment_distanter_median, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(covidgovernment_distanter_median),2),
             `St.Dev` = round(sd(covidgovernment_distanter_median),2),
             `Min.Value` = min(covidgovernment_distanter_median),
             `Max.Value` = max(covidgovernment_distanter_median)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Distance from Median (R) on COVID Government Position")

d1f <- w1 %>% 
   select(covidgovernment_distanter_mean, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(covidgovernment_distanter_mean),2),
             `St.Dev` = round(sd(covidgovernment_distanter_mean),2),
             `Min.Value` = min(covidgovernment_distanter_mean),
             `Max.Value` = max(covidgovernment_distanter_mean)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Distance from Mean (R) on COVID Government Position")

d1g <- w1 %>% 
   select(generalcovidgovernment_distanter_median, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(generalcovidgovernment_distanter_median),2),
             `St.Dev` = round(sd(generalcovidgovernment_distanter_median),2),
             `Min.Value` = min(generalcovidgovernment_distanter_median),
             `Max.Value` = max(generalcovidgovernment_distanter_median)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Distance from Median (S) on COVID Government Position")

d1h <- w1 %>% 
   select(generalcovidgovernment_distanter_mean, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(generalcovidgovernment_distanter_mean),2),
             `St.Dev` = round(sd(generalcovidgovernment_distanter_mean),2),
             `Min.Value` = min(generalcovidgovernment_distanter_mean),
             `Max.Value` = max(generalcovidgovernment_distanter_mean)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Distance from Mean (S) on COVID Government Position")

d <- d1a %>% 
   add_case(d1b) %>% 
   add_case(d1c) %>% 
   add_case(d1d) %>% 
   add_case(d1e) %>% 
   add_case(d1f) %>% 
   add_case(d1g) %>% 
   add_case(d1h) %>% 
   select(Country = country,Study = study,
          Variable, `Mean Value`, `St.Dev`, 
          `Min.Value`, `Max.Value`) %>%
   mutate(Country = recode(Country,
                           `DE` = "Germany",
                           `FR` = "France",
                           `IT` = "Italy",
                           `PL` = "Poland",
                           `SP` = "Spain",
                           `SW` = "Sweden")) %>% 
   select(-Study)

kbl(d[1:30,], booktabs =T, caption = "\\label{tab:ivh2-1}Descriptive Information - Independent Variables for H2 (1)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.2cm") %>%
  column_spec(2, width = "8cm") %>%
  column_spec(4, width = "1.5cm") %>%
  column_spec(5, width = "1.2cm") %>%
  column_spec(6, width = "1.2cm") %>%
  column_spec(7, width = "1.2cm")

kbl(d[31:dim(d)[1],], booktabs =T, caption = "\\label{tab:ivh2-2}Descriptive Information - Independent Variables for H2 (2)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.2cm") %>%
  column_spec(2, width = "8cm") %>%
  column_spec(4, width = "1.5cm") %>%
  column_spec(5, width = "1.2cm") %>%
  column_spec(6, width = "1.2cm") %>%
  column_spec(7, width = "1.2cm")
```

## Control Variables
As control variables, the following _demographics_ are measured:

- _Gender_ is measured as `sex`. The answer categories are `Male` (value of `1`), `Female` (value of `0`), and `No answer` (value of `999`).

- _Age_ is measured using age in years. 

- _Education_ is measured as the highest successfully completed level of education using 9 categories: `Doctorate, Post-doctorate or equivalent Completed`, `Incomplete Secondary Education`, `Less than primary`, `Postgraduate Education Completed`, `Primary education`, `Secondary Education`, .`Some University or Vocational Certification`, `Vocational or Professional Certification Completed`. We treat this variable as continues.

- _Employment_ Respondents were asked which category of employment -- `Full-time employed`, `Part-time employed`, `Entrepreneur`, `Unemployed and searching for a job`, `Unemployed and not searching for a job or incapacitated`, `Housewife/Househusband or else`, `Retired`, `Student or full-time education` -- applied most to them. 

- _Income_ Respondents were questioned on their monthly income wether they are `Coping on present income`, `Finding it difficult on present income`, `Finding it very difficult on present income`, `Living comfortably on present income`.

- _Religion_ Respondents were asked how often they attend religious services on a seven-point scale ranking from `never` (value of `1`) till `every day` (valuee of `7`).

\noindent Tables \ref{tab:controls1-1}, \ref{tab:controls1-2},  \ref{tab:controls1-3}, \ref{tab:controls1-4},\ref{tab:controls1-5}, \ref{tab:controls1-6}, \ref{tab:controls1-7}, \ref{tab:controls1-8}, and \ref{tab:controls2} demonstrate the averages across countries.

```{r controls1, topcaption=TRUE}
d1a <- w1 %>% 
   select(gender, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(gender),
             Variable = names(table(gender)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 1") %>% 
   select(-Tot)

d2a <- w2 %>% 
   select(gender, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(gender),
             Variable = names(table(gender)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 2") %>% 
   select(-Tot)

d1b <- w1 %>% 
   select(education, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(education),
             Variable = names(table(education)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 1") %>% 
   select(-Tot)

d2b <- w2 %>% 
   select(education, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(education),
             Variable = names(table(education)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 2") %>% 
   select(-Tot)

d1c <- w1 %>% 
   select(income, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(income),
             Variable = names(table(income)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 1") %>% 
   select(-Tot)

d2c <- w2 %>% 
   select(income, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(income),
             Variable = names(table(income)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 2") %>% 
   select(-Tot)

d1d <- w1 %>% 
   select(job, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(job),
             Variable = names(table(job)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 1") %>% 
   select(-Tot)

d2d <- w2 %>% 
   select(job, country) %>%
   group_by(country) %>% 
   summarise(`Frequency` = table(job),
             Variable = names(table(job)),
             Tot = table(country)) %>% 
   ungroup() %>% 
   mutate(Frequency = Frequency/Tot,
          Study = "Study 2") %>% 
   select(-Tot)

d <- d1a %>% 
   add_case(d1b) %>% 
   add_case(d1c) %>% 
   add_case(d1d) %>% 
   add_case(d2a) %>% 
   add_case(d2b) %>% 
   add_case(d2c) %>% 
   add_case(d2d) %>% 
   select(Country = country,Study,
          Variable, `Frequency (%)` = Frequency) %>%
   mutate(Country = recode(Country,
                           `DE` = "Germany",
                           `FR` = "France",
                           `IT` = "Italy",
                           `PL` = "Poland",
                           `SP` = "Spain",
                           `SW` = "Sweden")) 

kbl(d[1:40,], booktabs =T, caption = "\\label{tab:controls1-1}Descriptive Information - Demographic Controls (Categorical) (1)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

kbl(d[41:80,], booktabs =T, caption = "\\label{tab:controls1-2}Descriptive Information - Demographic Controls (Categorical) (2)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

kbl(d[81:120,], booktabs =T, caption = "\\label{tab:controls1-3}Descriptive Information - Demographic Controls (Categorical) (3)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

kbl(d[121:160,], booktabs =T, caption = "\\label{tab:controls1-4}Descriptive Information - Demographic Controls (Categorical) (4)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

kbl(d[161:200,], booktabs =T, caption = "\\label{tab:controls1-5}Descriptive Information - Demographic Controls (Categorical) (5)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

kbl(d[201:240,], booktabs =T, caption = "\\label{tab:controls1-6}Descriptive Information - Demographic Controls (Categorical) (6)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

kbl(d[241:280,], booktabs =T, caption = "\\label{tab:controls1-7}Descriptive Information - Demographic Controls (Categorical) (7)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

kbl(d[281:dim(d)[1],], booktabs =T, caption = "\\label{tab:controls1-8}Descriptive Information - Demographic Controls (Categorical) (8)") %>% 
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "10cm") %>%
  column_spec(4, width = "1.5cm")

#controls: age & religion

d1a <- w1 %>% 
   select(age, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(age),2),
             `St.Dev` = round(sd(age),2),
             `Min.Value` = min(age),
             `Max.Value` = max(age)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Age")

d2a <- w2 %>% 
   select(age, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(age),2),
             `St.Dev` = round(sd(age),2),
             `Min.Value` = min(age),
             `Max.Value` = max(age)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Age")

d1b <- w1 %>% 
   select(religion, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(religion),2),
             `St.Dev` = round(sd(religion),2),
             `Min.Value` = min(religion),
             `Max.Value` = max(religion)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Religion")

d2b <- w2 %>% 
   select(religion, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(religion),2),
             `St.Dev` = round(sd(religion),2),
             `Min.Value` = min(religion),
             `Max.Value` = max(religion)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Religion")

d <- d1a %>% 
   add_case(d1b) %>% 
   add_case(d2a) %>% 
   add_case(d2b) %>% 
   select(Country = country,Study = study,
          Variable, `Mean Value`, `St.Dev`, 
          `Min.Value`, `Max.Value`) %>%
   mutate(Country = recode(Country,
                           `DE` = "Germany",
                           `FR` = "France",
                           `IT` = "Italy",
                           `PL` = "Poland",
                           `SP` = "Spain",
                           `SW` = "Sweden")) 

kbl(d, booktabs =T, caption = "\\label{tab:controls2}Descriptive Information - Demographic Controls (Continuous)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.2cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "5cm") %>%
  column_spec(4, width = "1.5cm") %>%
  column_spec(5, width = "1.2cm") %>%
  column_spec(6, width = "1.2cm") %>%
  column_spec(7, width = "1.2cm")
```

In addition, we control for the following political attitudes of the respondents:

- _Trust Index_ Respondents were asked on an 11-point scale how much they trust others, parliament, local goverenment, the police, the health care system, the judiciary, and the EU, with `0` being no trust and `10` full trust. These measures are taken together in an additive scale with a Cronbach Alpha value over `0.75`.

- _Economic Left-Right Positions_ Respondents were asked on an 11-point scale whether the state should intervene in the economy (value of `0`) or let the market determine the econome (value of `10`).

- _Progressive-Conservative Positions_ Respondents were asked on an 11-point scale whether immigrants should be able to keep their own culture (value of `0`) or fully assimilate (value of `10`).

- _Position toward Women Working_ Respondents where asked on aa 5-point Likert scale whether they fully disagree (value of `1`), disagree (value of `2`), are neutral value of `3`), agreeing value of `4`), or fully agreeing (value of `5`) with the statement "_Men should have more right to work than women when jobs are scarce_".

- _Position on Climate Change_ Respondents were asked _On a 0-10 scale, do you believe that climate change will have a null or very limited impact on the lives of future generations or that its impact will be dramatic?_.

- _Evaluation of the Economy_ Respondents where asked on a 5-point scale if they think their economic situation deteriorated (value of `1`) or improved (value of `5`).

- _Prospects for the Economy_ Respondents where asked on a 5-point scale if they think their economic situation will deteriorate (value of `1`) or will improve (value of `5`).

\noindent Tables \ref{tab:controls3-1}, \ref{tab:controls3-2},  \ref{tab:controls3-3}, and \ref{tab:controls3-4} demonstrate the averages across countries.

```{r controls2, topcaption=TRUE}
d1a <- w1 %>%
   add_index(trust_index, matches("trust_"),
            type = "mean") %>% 
   select(trust_index, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(trust_index),2),
             `St.Dev` = round(sd(trust_index),2),
             `Min.Value` = min(trust_index),
             `Max.Value` = max(trust_index)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Trust Index")

d2a <- w2 %>% 
   add_index(trust_index, matches("trust_"),
            type = "mean") %>% 
   select(trust_index, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(trust_index),2),
             `St.Dev` = round(sd(trust_index),2),
             `Min.Value` = min(trust_index),
             `Max.Value` = max(trust_index)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Trust Index")

d1b <- w1 %>% 
   select(role_state_economy, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(role_state_economy),2),
             `St.Dev` = round(sd(role_state_economy),2),
             `Min.Value` = min(role_state_economy),
             `Max.Value` = max(role_state_economy)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Economic Left-Right Position")

d2b <- w2 %>% 
   select(role_state_economy, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(role_state_economy),2),
             `St.Dev` = round(sd(role_state_economy),2),
             `Min.Value` = min(role_state_economy),
             `Max.Value` = max(role_state_economy)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Economic Left-Right Position")

d1c <- w1 %>% 
   select(cult_immigration, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(cult_immigration),2),
             `St.Dev` = round(sd(cult_immigration),2),
             `Min.Value` = min(cult_immigration),
             `Max.Value` = max(cult_immigration)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Progressive-Conservative Position")

d2c <- w2 %>% 
   select(cult_immigration, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(cult_immigration),2),
             `St.Dev` = round(sd(cult_immigration),2),
             `Min.Value` = min(cult_immigration),
             `Max.Value` = max(cult_immigration)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Progressive-Conservative Position")

d1d <- w1 %>% 
   select(gender_workforce, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(gender_workforce),2),
             `St.Dev` = round(sd(gender_workforce),2),
             `Min.Value` = min(gender_workforce),
             `Max.Value` = max(gender_workforce)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Position towards Women Working")

d2d <- w2 %>% 
   select(gender_workforce, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(gender_workforce),2),
             `St.Dev` = round(sd(gender_workforce),2),
             `Min.Value` = min(gender_workforce),
             `Max.Value` = max(gender_workforce)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Position towards Women Working")

d1e <- w1 %>% 
   select(impact_climate, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(impact_climate),2),
             `St.Dev` = round(sd(impact_climate),2),
             `Min.Value` = min(impact_climate),
             `Max.Value` = max(impact_climate)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Position on Climate Change")

d2e <- w2 %>% 
   select(impact_climate, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(impact_climate),2),
             `St.Dev` = round(sd(impact_climate),2),
             `Min.Value` = min(impact_climate),
             `Max.Value` = max(impact_climate)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Position on Climate Change")

d1f <- w1 %>% 
   select(economic_eval, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(economic_eval),2),
             `St.Dev` = round(sd(economic_eval),2),
             `Min.Value` = min(economic_eval),
             `Max.Value` = max(economic_eval)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Evaluation of the Economy")

d2f <- w2 %>% 
   select(economic_eval, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(economic_eval),2),
             `St.Dev` = round(sd(economic_eval),2),
             `Min.Value` = min(economic_eval),
             `Max.Value` = max(economic_eval)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Evaluation of the Economy") 

d1g <- w1 %>% 
   select(economic_prospect, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(economic_prospect),2),
             `St.Dev` = round(sd(economic_prospect),2),
             `Min.Value` = min(economic_prospect),
             `Max.Value` = max(economic_prospect)) %>%
   ungroup() %>% 
   mutate(study = "Study 1",
          Variable = "Prospect of the Economy")

d2g <- w2 %>% 
   select(economic_prospect, country) %>%
   group_by(country) %>% 
   summarise(`Mean Value` = round(mean(economic_prospect),2),
             `St.Dev` = round(sd(economic_prospect),2),
             `Min.Value` = min(economic_prospect),
             `Max.Value` = max(economic_prospect)) %>%
   ungroup() %>% 
   mutate(study = "Study 2",
          Variable = "Prospect of the Economy")   
                   
d <- d1a %>% 
   add_case(d1b) %>% 
   add_case(d1c) %>% 
   add_case(d1d) %>% 
   add_case(d1e) %>% 
   add_case(d1f) %>% 
   add_case(d1g) %>% 
   add_case(d2a) %>% 
   add_case(d2b) %>% 
   add_case(d2c) %>% 
   add_case(d2d) %>%
   add_case(d2e) %>% 
   add_case(d2f) %>% 
   add_case(d2g) %>% 
   select(Country = country,Study = study,
          Variable, `Mean Value`, `St.Dev`, 
          `Min.Value`, `Max.Value`) %>%
   mutate(Country = recode(Country,
                           `DE` = "Germany",
                           `FR` = "France",
                           `IT` = "Italy",
                           `PL` = "Poland",
                           `SP` = "Spain",
                           `SW` = "Sweden"))

kbl(d[1:25,], booktabs =T, caption = "\\label{tab:controls3-1}Descriptive Information - Political Controls (1)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "4cm") %>%
  column_spec(4, width = "2cm") %>%
  column_spec(5, width = "1.5cm") %>%
  column_spec(6, width = "1.5cm")  %>%
  column_spec(7, width = "1.5cm") 

kbl(d[26:50,], booktabs =T, caption = "\\label{tab:controls3-2}Descriptive Information - Political Controls (2)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "4cm") %>%
  column_spec(4, width = "2cm") %>%
  column_spec(5, width = "1.5cm") %>%
  column_spec(6, width = "1.5cm")  %>%
  column_spec(7, width = "1.5cm") 

kbl(d[51:65,], booktabs =T, caption = "\\label{tab:controls3-3}Descriptive Information - Political Controls (3)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "4cm") %>%
  column_spec(4, width = "2cm") %>%
  column_spec(5, width = "1.5cm") %>%
  column_spec(6, width = "1.5cm")  %>%
  column_spec(7, width = "1.5cm") 

kbl(d[66:dim(d)[1],], booktabs =T, caption = "\\label{tab:controls3-4}Descriptive Information - Political Controls (4)") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F, fixed_thead = T, position = "center") %>%
  column_spec(1, width = "1.5cm") %>%
  column_spec(2, width = "1.5cm") %>%
  column_spec(3, width = "4cm") %>%
  column_spec(4, width = "2cm") %>%
  column_spec(5, width = "1.5cm") %>%
  column_spec(6, width = "1.5cm")  %>%
  column_spec(7, width = "1.5cm") 
```

